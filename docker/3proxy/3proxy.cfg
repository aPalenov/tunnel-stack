# 3proxy configuration: HTTP + SOCKS5 with IP allowlist
# Runs in foreground inside Docker (no 'daemon').

# DNS cache and timeouts (optional tweaks)
# nscache 65536
# timeouts 1 5 30 60 180 1800 15 60

# IP-only auth: decisions based on client source IP
auth iponly

# Log to stdout to observe access decisions
log /dev/stdout D
logformat "L%Y-%m-%dT%H:%M:%S %e %U %C:%c %R:%r %O %I %n"

# Allowed IPs are managed in a separate file for convenience
include /data/allow.list

# Deny everything else explicitly
deny *

# HTTP proxy on 3128 (TCP)
proxy -p3128

# SOCKS5 on 1080 (TCP + UDP associate)
socks -p1080
